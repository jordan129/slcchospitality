<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  {{- $brand := site.Data.site.brand.name -}}

  {{/* -------------------------
      SEO title (single-line)
      Priority:
      1) .Params.seo_title (optional override)
      2) .Title (front matter title)
      3) brand fallback
     ------------------------- */}}
  {{- $title := $brand -}}
  {{- with .Params.seo_title -}}
    {{- $title = . -}}
  {{- else -}}
    {{- if .Title -}}
      {{- $title = .Title -}}
    {{- end -}}
  {{- end -}}
  <title>{{ $title }}</title>

  {{/* -------------------------
      Meta description
      Priority:
      1) .Params.description
      2) site tagline fallback
     ------------------------- */}}
  {{- $desc := "" -}}
  {{- with .Params.description -}}
    {{- $desc = . -}}
  {{- else -}}
    {{- with site.Data.site.brand.tagline -}}
      {{- $desc = . -}}
    {{- end -}}
  {{- end -}}
  {{- if $desc -}}
  <meta name="description" content="{{ $desc }}">
  {{- end -}}

  {{/* Canonical */}}
  <link rel="canonical" href="{{ .Permalink }}">

  {{/* -------------------------
      Open Graph / Twitter
     ------------------------- */}}
  <meta property="og:site_name" content="{{ $brand }}">
  <meta property="og:title" content="{{ $title }}">
  {{- if $desc -}}
  <meta property="og:description" content="{{ $desc }}">
  <meta name="twitter:description" content="{{ $desc }}">
  {{- end -}}
  <meta property="og:type" content="{{ if .IsHome }}website{{ else }}article{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  <meta name="twitter:card" content="summary_large_image">

  {{/* Social share image:
      - page-level: .Params.og_image
      - site-level fallback: site.Data.site.brand.og_image (optional)
      - final fallback: /images/og.jpg (optional, if you add it)
   */}}
  {{- $og := "" -}}
  {{- with .Params.og_image -}}
    {{- $og = . -}}
  {{- else -}}
    {{- with site.Data.site.brand.og_image -}}
      {{- $og = . -}}
    {{- end -}}
  {{- end -}}
  {{- if not $og -}}
    {{- if (fileExists "static/images/og.jpg") -}}
      {{- $og = "/images/og.jpg" -}}
    {{- end -}}
  {{- end -}}
  {{- if $og -}}
  <meta property="og:image" content="{{ $og | absURL }}">
  <meta name="twitter:image" content="{{ $og | absURL }}">
  {{- end -}}

  <link rel="stylesheet" href="/css/site.css">
  {{ partial "schema.html" . }}
</head>

<body>

{{ partial "announcement.html" . }}

<header class="site-header">
  <div class="nav-wrap">
    <a class="brand" href="/" aria-label="{{ $brand }} home">
      <img class="brand-logo" src="{{ site.Data.site.brand.logo }}" alt="{{ $brand }}">
    </a>

    <button class="nav-toggle" aria-label="Open menu" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>

    <nav class="nav-right" aria-label="primary">
      <a class="nav-link" href="/">Home</a>
      <a class="nav-link" href="{{ "contact/" | relURL }}">Contact</a>
      <a class="nav-link" href="{{ "menu/" | relURL }}">Menu</a>
      <a class="nav-link" href="{{ "lunch_specials/" | relURL }}">Lunch specials</a>

      <a class="nav-link nav-cta nav-cta-mobile"
         href="{{ site.Data.site.links.reservation_url }}"
         target="_blank" rel="noopener">Reservation</a>
    </nav>

    <div class="nav-backdrop" aria-hidden="true"></div>
  </div>
</header>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://sushimoka.co.uk/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Menu",
      "item": "https://sushimoka.co.uk/menu/"
    }
  ]
}
</script>

<main class="site-main">
  {{ block "main" . }}{{ end }}
</main>

<footer class="site-footer">
  {{ partial "footer.html" . }}
</footer>

<script src="/js/nav.js" defer></script>

{{ if .IsHome }}
<script src="/js/slider.js" defer></script>
{{ end }}

{{ if eq (.Params.page_kind | default "") "menu" }}
<script src="/js/menu.js" defer></script>
{{ end }}

<!-- WebP Support -->
{{ $images := resources.Match "images/*" }} <!-- 获取所有图片 -->
{{ range $index, $image := $images }}
  <picture>
    <!-- WebP 格式 -->
    <source srcset="{{ $image | .Resize "1000x800" | .ToWebp | .RelPermalink }} 1000w,
                    {{ $image | .Resize "800x600" | .ToWebp | .RelPermalink }} 800w,
                    {{ $image | .Resize "400x300" | .ToWebp | .RelPermalink }} 400w"
            sizes="(max-width: 1200px) 100vw, (max-width: 800px) 50vw, 33vw" type="image/webp">

    <!-- JPEG 格式 -->
    <source srcset="{{ $image | .Resize "1000x800" | .RelPermalink }} 1000w,
                    {{ $image | .Resize "800x600" | .RelPermalink }} 800w,
                    {{ $image | .Resize "400x300" | .RelPermalink }} 400w"
            sizes="(max-width: 1200px) 100vw, (max-width: 800px) 50vw, 33vw" type="image/jpeg">

    <!-- 默认 fallback 图片 -->
    <img src="{{ $image | .Resize "800x600" | .RelPermalink }}" alt="Sushi Moka - Fantastic Sushi in London" />
  </picture>
{{ end }}


</body>
</html>
